{"version":3,"sources":["../../../src/utils/init/init.js"],"names":["debug","Init","constructor","session","projectTemplates","allTemplates","concat","installedTemplates","map","templateName","templateSpec","name","description","getTemplatesChoices","template","grey","createFilesAndFolders","pathToCopyTo","process","cwd","copySync","dim","green","err","checkConfigFiles","existsSync","projectPath","checkIfInitiated","project","addConfigFiles","projectParams","settings","account","addProject","join","load","instance","noConfigFiles"],"mappings":";;;;;;AAAA;;;;AACA;;;;AACA;;;;AAEA;;;;AACA;;;;AACA;;AACA;;;;;;AAOA,MAAM,EAAEA,KAAF,KAAY,qBAAO,YAAP,CAAlB;;AAEA,MAAMC,IAAN,CAAW;AACTC,gBAAe;AACb,SAAKC,OAAL;AACD;;AAED,SAAOC,gBAAP,GAA2B;AACzB,UAAMC,eAAe,mCAAwBC,MAAxB,CAA+B,2CAA/B,CAArB;AACA,UAAMC,qBAAqBF,aAAaG,GAAb,CAAiBC,gBAAgB;AAC1DT,YAAM,mBAAN,EAA2BS,YAA3B;AACA,YAAMC,eAAe,gCAAgBD,YAAhB,CAArB;;AAEA,aAAO,EAAEE,MAAMF,YAAR,EAAsBG,aAAaF,aAAaE,WAAhD,EAAP;AACD,KAL0B,CAA3B;AAMA,WAAOL,kBAAP;AACD;;AAED,SAAOM,mBAAP,GAA8B;AAC5B,WAAOZ,KAAKG,gBAAL,GAAwBI,GAAxB,CAA4BM,YAAa,GAAEA,SAASF,WAAY,IAAG,gBAAOG,IAAP,CAAa,MAAKD,SAASH,IAAK,GAAhC,CAAoC,EAAvG,CAAP;AACD;;AAEDK,wBAAuBC,eAAeC,QAAQC,GAAR,EAAtC,EAAqD;AACnDnB,UAAM,yBAAN;;AAEA,QAAI;AACFA,YAAM,gBAAN,EAAwB,KAAKS,YAA7B;AACAT,YAAM,kBAAN,EAA0BiB,YAA1B;AACA,wBAAGG,QAAH,CAAY,4BAAY,KAAKX,YAAjB,CAAZ,EAA4CQ,YAA5C;AACA,4BAAK,CAAL,EAAQ,gBAAOI,GAAP,CAAY,iCAAgC,gBAAOC,KAAP,CAAa,KAAKb,YAAlB,CAAgC,YAA5E,CAAR;AACA;AACD,KAND,CAME,OAAOc,GAAP,EAAY;AACZ,4BAAKA,GAAL;AACA,YAAMA,GAAN;AACD;AACF;;AAEDC,qBAAoB;AAClB,WAAO,CAAC,kBAAGC,UAAH,CAAc,KAAKtB,OAAL,CAAauB,WAA3B,CAAR;AACD;;AAEDC,qBAAoB;AAClB,WAAO,kBAAGF,UAAH,CAAc,KAAKtB,OAAL,CAAauB,WAA3B,KAA2C,KAAKvB,OAAL,CAAayB,OAA/D;AACD;;AAEKC,gBAAN,CAAsBC,gBAAgB,EAAtC,EAA0CJ,WAA1C,EAAuD;AAAA;;AAAA;AACrD,UAAIA,WAAJ,EAAiB;AACf,cAAKvB,OAAL,CAAa4B,QAAb,CAAsBC,OAAtB,CAA8BC,UAA9B,CAAyCP,WAAzC,EAAsDI,aAAtD;AACD,OAFD,MAEO;AACL,cAAK3B,OAAL,CAAa4B,QAAb,CAAsBC,OAAtB,CAA8BC,UAA9B,CAAyC,eAAKC,IAAL,CAAUhB,QAAQC,GAAR,EAAV,EAAyB,SAAzB,CAAzC,EAA8EW,aAA9E;AACD;AACD,YAAM,MAAK3B,OAAL,CAAagC,IAAb,EAAN;;AAEA,4BAAK,CAAL,EAAS,+BAA8B,gBAAOb,KAAP,CAAaQ,cAAcM,QAA3B,CAAqC,gBAA5E;AARqD;AAStD;;AAEDC,kBAAiB;AACfrC,UAAM,iBAAN;AACA,SAAKgB,qBAAL;AACD;AAzDQ;;kBA4DIf,I","file":"init.js","sourcesContent":["import fs from 'fs-extra'\nimport format from 'chalk'\nimport path from 'path'\n\nimport session from '../session'\nimport logger from '../debug'\nimport { echo } from '../print-tools'\nimport {\n  getTemplateSpec,\n  getTemplate,\n  builtInProjectTemplates,\n  installedProjectTemplates\n} from '../templates'\n\nconst { debug } = logger('utils-init')\n\nclass Init {\n  constructor () {\n    this.session = session\n  }\n\n  static projectTemplates () {\n    const allTemplates = builtInProjectTemplates.concat(installedProjectTemplates())\n    const installedTemplates = allTemplates.map(templateName => {\n      debug('loading template:', templateName)\n      const templateSpec = getTemplateSpec(templateName)\n\n      return { name: templateName, description: templateSpec.description }\n    })\n    return installedTemplates\n  }\n\n  static getTemplatesChoices () {\n    return Init.projectTemplates().map(template => `${template.description} ${format.grey(`- (${template.name})`)}`)\n  }\n\n  createFilesAndFolders (pathToCopyTo = process.cwd()) {\n    debug('createFilesAndFolders()')\n\n    try {\n      debug('Template name:', this.templateName)\n      debug('Path to copy to:', pathToCopyTo)\n      fs.copySync(getTemplate(this.templateName), pathToCopyTo)\n      echo(4)(format.dim(`Project has been created from ${format.green(this.templateName)} template.`))\n      echo()\n    } catch (err) {\n      echo(err)\n      throw err\n    }\n  }\n\n  checkConfigFiles () {\n    return !fs.existsSync(this.session.projectPath)\n  }\n\n  checkIfInitiated () {\n    return fs.existsSync(this.session.projectPath) && this.session.project\n  }\n\n  async addConfigFiles (projectParams = {}, projectPath) {\n    if (projectPath) {\n      this.session.settings.account.addProject(projectPath, projectParams)\n    } else {\n      this.session.settings.account.addProject(path.join(process.cwd(), 'syncano'), projectParams)\n    }\n    await this.session.load()\n\n    echo(4)(`Your project is attached to ${format.green(projectParams.instance)} instance now!`)\n  }\n\n  noConfigFiles () {\n    debug('noConfigFiles()')\n    this.createFilesAndFolders()\n  }\n}\n\nexport default Init\n"]}