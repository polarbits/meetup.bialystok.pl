{"version":3,"sources":["../../src/utils/templates.js"],"names":["debug","getTemplatePath","templateName","options","paths","join","process","cwd","dirname","require","resolve","getTemplateSpec","templatePath","JSON","parse","readFileSync","getTemplate","builtInSocketTemplates","builtInProjectTemplates","findInstalledTemplates","pattern","configFile","regex","RegExp","devDeps","findKey","devDependencies","obj","key","match","deps","dependencies","concat","err","installedProjectTemplates","installedSocketTemplates"],"mappings":";;;;;;AAAA;;;;AACA;;;;AACA;;;;AACA;;;;;;AAEA,MAAM,EAAEA,KAAF,KAAY,qBAAO,UAAP,CAAlB;;AAEA,MAAMC,kBAAmBC,YAAD,IAAkB;AACxCF,QAAM,iBAAN,EAAyBE,YAAzB;AACA,QAAMC,UAAU,EAAEC,OAAO,CAAC,eAAKC,IAAL,CAAUC,QAAQC,GAAR,EAAV,EAAyB,cAAzB,CAAD,CAAT,EAAhB;AACA,SAAO,eAAKC,OAAL,CAAaC,QAAQC,OAAR,CAAgBR,YAAhB,EAA8BC,OAA9B,CAAb,CAAP;AACD,CAJD;;AAMA,MAAMQ,kBAAmBT,YAAD,IAAkB;AACxC,QAAMU,eAAeX,gBAAgBC,YAAhB,CAArB;AACAF,QAAM,iBAAN,EAAyBY,YAAzB;AACA,SAAOC,KAAKC,KAAL,CACL,aAAGC,YAAH,CAAgB,eAAKV,IAAL,CAAUO,YAAV,EAAwB,cAAxB,CAAhB,CADK,CAAP;AAGD,CAND;;AAQA,SAASI,WAAT,CAAsBd,YAAtB,EAAoC;AAClCF,QAAM,aAAN,EAAqBE,YAArB;AACA,QAAMU,eAAeX,gBAAgBC,YAAhB,CAArB;AACA,SAAO,eAAKG,IAAL,CAAUO,YAAV,EAAwB,UAAxB,CAAP;AACD;;AAED,MAAMK,yBAAyB,CAC7B,kCAD6B,EAE7B,8BAF6B,CAA/B;;AAKA,MAAMC,0BAA0B,CAC9B,iCAD8B,EAE9B,iCAF8B,CAAhC;;AAKA,MAAMC,yBAA0BC,OAAD,IAAa;AAC1CpB,QAAM,wBAAN,EAAgCoB,OAAhC;AACA,MAAI;AACF,UAAMC,aAAaR,KAAKC,KAAL,CAAW,aAAGC,YAAH,CAAgB,eAAKV,IAAL,CAAUC,QAAQC,GAAR,EAAV,EAAyB,cAAzB,CAAhB,CAAX,CAAnB;AACA,UAAMe,QAAQ,IAAIC,MAAJ,CAAWH,OAAX,CAAd;AACA,UAAMI,UAAU,iBAAEC,OAAF,CAAUJ,WAAWK,eAArB,EAAsC,CAACC,GAAD,EAAMC,GAAN,KAAcA,IAAIC,KAAJ,CAAUP,KAAV,CAApD,CAAhB;AACA,UAAMQ,OAAO,iBAAEL,OAAF,CAAUJ,WAAWU,YAArB,EAAmC,CAACJ,GAAD,EAAMC,GAAN,KAAcA,IAAIC,KAAJ,CAAUP,KAAV,CAAjD,CAAb;AACA,WAAO,GAAGU,MAAH,CAAUR,WAAW,EAArB,EAAyBM,QAAQ,EAAjC,CAAP;AACD,GAND,CAME,OAAOG,GAAP,EAAY;AACZjC,UAAMiC,GAAN;AACA,WAAO,EAAP;AACD;AACF,CAZD;;AAcA,MAAMC,4BAA4B,MAAM;AACtC,SAAOf,uBAAuB,0BAAvB,CAAP;AACD,CAFD;;AAIA,MAAMgB,2BAA2B,MAAM;AACrC,SAAOhB,uBAAuB,yBAAvB,CAAP;AACD,CAFD;;kBAIe;AACbH,aADa;AAEbL,iBAFa;AAGbM,wBAHa;AAIbC,yBAJa;AAKbgB,2BALa;AAMbC;AANa,C","file":"templates.js","sourcesContent":["import _ from 'lodash'\nimport fs from 'fs'\nimport path from 'path'\nimport logger from './debug'\n\nconst { debug } = logger('template')\n\nconst getTemplatePath = (templateName) => {\n  debug('getTemplatePath', templateName)\n  const options = { paths: [path.join(process.cwd(), 'node_modules')] }\n  return path.dirname(require.resolve(templateName, options))\n}\n\nconst getTemplateSpec = (templateName) => {\n  const templatePath = getTemplatePath(templateName)\n  debug('getTemplateSpec', templatePath)\n  return JSON.parse(\n    fs.readFileSync(path.join(templatePath, 'package.json'))\n  )\n}\n\nfunction getTemplate (templateName) {\n  debug('getTemplate', templateName)\n  const templatePath = getTemplatePath(templateName)\n  return path.join(templatePath, 'template')\n}\n\nconst builtInSocketTemplates = [\n  '@syncano/template-socket-vanilla',\n  '@syncano/template-socket-es6'\n]\n\nconst builtInProjectTemplates = [\n  '@syncano/template-project-empty',\n  '@syncano/template-project-hello'\n]\n\nconst findInstalledTemplates = (pattern) => {\n  debug('findInstalledTemplates', pattern)\n  try {\n    const configFile = JSON.parse(fs.readFileSync(path.join(process.cwd(), 'package.json')))\n    const regex = new RegExp(pattern)\n    const devDeps = _.findKey(configFile.devDependencies, (obj, key) => key.match(regex))\n    const deps = _.findKey(configFile.dependencies, (obj, key) => key.match(regex))\n    return [].concat(devDeps || [], deps || [])\n  } catch (err) {\n    debug(err)\n    return []\n  }\n}\n\nconst installedProjectTemplates = () => {\n  return findInstalledTemplates('syncano-template-project')\n}\n\nconst installedSocketTemplates = () => {\n  return findInstalledTemplates('syncano-template-socket')\n}\n\nexport default {\n  getTemplate,\n  getTemplateSpec,\n  builtInSocketTemplates,\n  builtInProjectTemplates,\n  installedProjectTemplates,\n  installedSocketTemplates\n}\n"]}