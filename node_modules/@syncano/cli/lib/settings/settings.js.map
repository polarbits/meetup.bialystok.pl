{"version":3,"sources":["../../src/settings/settings.js"],"names":["warn","info","debug","Settings","constructor","attributes","configPath","load","join","baseDir","name","accessSync","err","R_OK","readFileSync","process","exit","save","writeFileSync","dump","handle","get","key","set","value"],"mappings":";;;;;;AAAA;;;;AACA;;;;AACA;;;;AAEA;;;;AACA;;;;AACA;;;;AAEA,MAAM,EAAEA,IAAF,EAAQC,IAAR,EAAcC,KAAd,KAAwB,qBAAO,UAAP,CAA9B;;AAEe,MAAMC,QAAN,CAAe;AAC5BC,gBAAe;AACb,SAAKC,UAAL,GAAkB,EAAlB;AACA,SAAKC,UAAL,GAAkB,IAAlB;AACD;;AAEDC,SAAQ;AACN,SAAKD,UAAL,GAAkB,eAAKE,IAAL,CAAU,KAAKC,OAAf,EAAyB,GAAE,KAAKC,IAAK,MAArC,CAAlB;;AAEA,QAAI;AACF,mBAAGC,UAAH,CAAc,KAAKF,OAAnB;AACD,KAFD,CAEE,OAAOG,GAAP,EAAY;AACZ,aAAO,KAAP;AACD;;AAEDX,SAAM,WAAU,KAAKS,IAAK,MAAK,KAAKJ,UAAW,EAA/C;;AAEA,QAAI;AACFL,WAAM,aAAY,KAAKK,UAAW,EAAlC;AACA,mBAAGK,UAAH,CAAc,KAAKL,UAAnB,EAA+B,aAAGO,IAAlC;AACD,KAHD,CAGE,OAAOD,GAAP,EAAY;AACZZ,WAAK,wBAAL;AACA,aAAO,KAAP;AACD;;AAED,QAAI;AACF,WAAKK,UAAL,GAAkB,iBAAKE,IAAL,CAAU,aAAGO,YAAH,CAAgB,KAAKR,UAArB,EAAiC,MAAjC,CAAV,KAAuD,EAAzE;AACD,KAFD,CAEE,OAAOM,GAAP,EAAY;AACZ,6BAAMA,GAAN,EAAW,mBAAE,EAAF,EAAO,YAAW,KAAKN,UAAW,EAAlC,CAAX;AACAS,cAAQC,IAAR,CAAa,CAAb;AACD;;AAED,WAAO,IAAP;AACD;;AAEDC,SAAQ;AACNf,UAAO,UAAS,KAAKI,UAAW,EAAhC;AACA,QAAI;AACF,mBAAGY,aAAH,CAAiB,KAAKZ,UAAtB,EAAkC,iBAAKa,IAAL,CAAU,KAAKd,UAAf,CAAlC;AACD,KAFD,CAEE,OAAOO,GAAP,EAAY;AACZ,aAAO,4BAAkB,IAAlB,EAAwBQ,MAAxB,CAA+BR,GAA/B,CAAP;AACD;AACF;;AAEDS,MAAKC,GAAL,EAAU;AACR,WAAO,KAAKjB,UAAL,CAAgBiB,GAAhB,KAAwB,IAA/B;AACD;;AAEDC,MAAKD,GAAL,EAAUE,KAAV,EAAiBP,IAAjB,EAAuB;AACrB,SAAKZ,UAAL,CAAgBiB,GAAhB,IAAuBE,KAAvB;AACA,QAAIP,SAAS,KAAb,EAAoB,KAAKA,IAAL;AACpB,WAAO,IAAP;AACD;AApD2B;kBAATd,Q","file":"settings.js","sourcesContent":["import fs from 'fs'\nimport path from 'path'\nimport YAML from 'js-yaml'\n\nimport logger from '../utils/debug'\nimport ErrorResponse from '../utils/error-response'\nimport { error, p } from '../utils/print-tools'\n\nconst { warn, info, debug } = logger('settings')\n\nexport default class Settings {\n  constructor () {\n    this.attributes = {}\n    this.configPath = null\n  }\n\n  load () {\n    this.configPath = path.join(this.baseDir, `${this.name}.yml`)\n\n    try {\n      fs.accessSync(this.baseDir)\n    } catch (err) {\n      return false\n    }\n\n    info(`Loading ${this.name} - ${this.configPath}`)\n\n    try {\n      info(`Checking: ${this.configPath}`)\n      fs.accessSync(this.configPath, fs.R_OK)\n    } catch (err) {\n      warn('Config doesn\\'t exist!')\n      return false\n    }\n\n    try {\n      this.attributes = YAML.load(fs.readFileSync(this.configPath, 'utf8')) || {}\n    } catch (err) {\n      error(err, p(10)(`at file: ${this.configPath}`))\n      process.exit(1)\n    }\n\n    return true\n  }\n\n  save () {\n    debug(`Saving ${this.configPath}`)\n    try {\n      fs.writeFileSync(this.configPath, YAML.dump(this.attributes))\n    } catch (err) {\n      return new ErrorResponse(this).handle(err)\n    }\n  }\n\n  get (key) {\n    return this.attributes[key] || null\n  }\n\n  set (key, value, save) {\n    this.attributes[key] = value\n    if (save !== false) this.save()\n    return this\n  }\n}\n"]}